


SELECT TO_CHAR(TO_DATE(MAX(A.SALE_DATE),'YYYY-MM-DD'),'YYYY-MM-DD') AS SALE_DATE,
    GET_COMMCODE(MAX(B.CORP_CODE),'BS012', MAX(B.DAY_TYPE_CODE)) AS DAY_TYPE
FROM BAA06S A INNER JOIN BSH01M B ON (A.CORP_CODE = B.CORP_CODE AND B.CALENDAR_CODE = '200' AND A.SALE_DATE = B.SALE_DATE)
WHERE A.corp_code = P_CORP_CODE
AND A.upjang_code = P_UPJANG_CODE
AND A.CLS_YN <> 'Y';