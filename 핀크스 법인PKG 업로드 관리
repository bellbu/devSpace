* 법인PKG업로드관리
테이블: CRA06M_TEMP(법인패키지업로드), CRA06D_TEMP(법인패키지업로드상세)

1. 법인 패키지 업로드 그리드(CRA06M_TEMP와 CRA06D_TEMP 이너조인)
2. 법인패키지업로드상세 그리드(CRA06D_TEMP)
  0)업로드 엑셀: PKG_CorpMemberPkgUpload.SP_CRA06M_TEMP_INSERT => PKG_CorpMemberPkgUpload.SP_CRA06D_TEMP_INSERT
  1)검증: PKG_CorpMemberPkgUpload.SP_CRA06D_TEMP_CHECK (CRA06D_TEMP테이블에 업데이트)
  2)저장: PKG_CorpMemberPkgUpload.SP_CRA06D_TEMP_UPDATE (CRA06D_TEMP테이블에 업데이트)
  3)확정: PKG_CorpMemberPkgUpload.SP_CRA06M_INSERT (CRA06D_TEMP => (본인NULL인 경우 CRA02M 인서트) => 본인, 배우자: CRA06M(법인패키지업로드내역))


* 법인PKG업로드내역
1. 법인패키지업로드내역 그리드(CRA06M): PKG_CorpMemberPkgUpload.SP_CRA06M_SELECT
2. 저장: PKG_CorpMemberPkgUpload.SP_CRA06M_UPDATE (CRA06M 테이블에 업데이트)
3. 확정: PKG_CorpMemberPkgUpload.SP_CPPKG_INSERT (본인/배우자 CRA01M에 존재하지 않는 경우 등록, 존재하는 경우 업데이트), (CRA04M 회원 혜택 마스터)




<법인PKG업로드관리-검증조건>
신규
(추가 확인) 비서 휴대폰 번호 중복 체크: 부적합(비서 휴대폰 번호 중복체크 제외)

공통
(추가 확인) 본인과 배우자 연락처 중복 체크: 본인/배우자의 연락처가 비서 연락처와 다른경우에만 체크
(추가 확인) 본인과 비서 연락처 중복 체크: 부적합(비서 연락처 중복체크 제외)
(추가 확인) 배우자과 비서 연락처 중복 체크: 부적합(비서 연락처 중복체크 제외)


<법인PKG업로드관리-검증조건>

신규
(추가 확인) 본인 휴대폰 번호 중복 체크: '휴대폰 번호 중복' 메시지 표출
(추가 확인) 배우자 휴대폰 번호 중복 체크: '배우자 휴드폰 번호 중복' 메시지 표출
(추가 확인) 비서 휴대폰 번호 중복 체크: '비서 휴드폰 번호 중복' 메시지 표출
가입구분이 '신규'인데, 기존 법인PKG 대상자인 경우
가입구분이 '신규'인데, E-Mail(CRA01M.USER_ID)이 이미 사용중인 경우 
가입구분이 '신규'인데, 가입코드(CRA01M.MEM_NO) 또는 본인 코드(CRA01M.GUEST_NO)가 입력 된 경우
가입구분이 '신규'인데, '전출입멤버사명' 또는 '전출입멤버사코드'가 입력 된 경우
(확인) 가입구분이 '신규'인데, 'PKG 구분' 항목에 'P', 'S', 'B' 외 값이 입력 된 경우(대소문자 구분 없이): 'PKG구분(M,P,S)' 메시지 표출

갱신
(추가 확인) PMS 회원정보의 연락처와 일치 확인: '회원 매칭 실패, 본인 연락처 확인(연락처 변경 시, PMS 회원정보 선 변경 처리)' 메세지 표출
(확인) 가입구분이 '갱신'인데, 기존 법인PKG 대상자가 아닌 경우: '전년가입여부 및 정보 확인' 메시지 표출
가입구분이 '갱신'인데, 가입코드(CRA01M.MEM_NO) 또는 본인 코드(CRA01M.GUEST_NO)가 미 입력 된 경우
가입구분이 '갱신'인데, '전출입멤버사명' 또는 '전출입멤버사코드'가 입력 된 경우
가입구분이 '갱신'인데, 가입코드(CRA01M.MEM_NO) 와 본인 코드(CRA01M.GUEST_NO) 정보가 불일치 하는 경우
(확인) 가입구분이 '갱신'인데, 'PKG 구분' 항목에 'P', 'S', 'B' 외 값이 입력 된 경우(대소문자 구분 없이): 'PKG구분(M,P,S)' 메시지 표출

전출
(추가 확인) PMS 회원정보의 연락처와 일치 확인: '회원 매칭 실패, 본인 연락처 확인(연락처 변경 시, PMS 회원정보 선 변경 처리)' 메세지 표출
(확인) 가입구분이 '전출'인데, 기존 법인PKG 대상자가 아닌 경우: '전년가입여부 및 정보 확인' 메시지 표출
가입구분이 '전출'인데, '전출입멤버사코드'가 미 입력 된 경우
가입구분이 '전출'인데, '전출입멤버사명'이 미 입력 된 경우
가입구분이 '전출'인데, '전출입멤버사코드'가 현재 멤버사코드와 동일한 경우
가입구분이 '전출'인데, '전출입멤버사명'이 현재 멤버사명과 동일한 경우
가입구분이 '전출'인데, 가입코드(CRA01M.MEM_NO) 또는 본인 코드(CRA01M.GUEST_NO)가 미 입력 된 경우
가입구분이 '전출'인데, 가입코드(CRA01M.MEM_NO) 와 본인 코드(CRA01M.GUEST_NO) 정보가 불일치 하는 경우
(추가) 가입구분이 '전입'인데, 'PKG 구분' 항목에 'P', 'S', 'B' 외 값이 입력 된 경우(대소문자 구분 없이): 'PKG구분(M,P,S)' 메시지 표출

전입
(확인)가입구분이 '전입'인데, 기존 법인PKG 대상자가 아닌 경우: '전출입 전년가입여부 확인' 메시지 표출
(확인) 가입구분이 '전입'인데, '전출입멤버사코드'가 미 입력 된 경우: '전출입맴버사명' 메시지 표출
(확인) 가입구분이 '전입'인데, '전출입멤버사명'이 미 입력 된 경우: '전출입맴버사명' 메시지 표출
가입구분이 '전입'인데, '전출입멤버사코드'가 현재 멤버사코드와 동일한 경우
가입구분이 '전입'인데, '전출입멤버사명'이 현재 멤버사명과 동일한 경우
가입구분이 '전입'인데, 가입코드(CRA01M.MEM_NO) 또는 본인 코드(CRA01M.GUEST_NO)가 미 입력 된 경우
가입구분이 '전입'인데, 가입코드(CRA01M.MEM_NO) 와 본인 코드(CRA01M.GUEST_NO) 정보가 불일치 하는 경우
(확인) 가입구분이 '전입'인데, 'PKG 구분' 항목에 'P', 'S', 'B' 외 값이 입력 된 경우(대소문자 구분 없이): 'PKG구분(M,P,S)' 메시지 표출

제외
(추가 확인) PMS 회원정보의 연락처와 일치 확인: '회원 매칭 실패, 본인 연락처 확인(연락처 변경 시, PMS 회원정보 선 변경 처리)' 메세지 표출
(확인) 가입구분이 '제외'인데, 기존 법인PKG 대상자가 아닌 경우: '전년가입여부 및 정보 확인' 메시지 표출
가입구분이 '제외'인데, 가입코드(CRA01M.MEM_NO) 또는 본인 코드(CRA01M.GUEST_NO)가 미 입력 된 경우
가입구분이 '제외'인데, '전출입멤버사명' 또는 '전출입멤버사코드'가 입력 된 경우
가입구분이 '제외'인데, 가입코드(CRA01M.MEM_NO) 와 본인 코드(CRA01M.GUEST_NO) 정보가 불일치 하는 경우
(추가 확인) 가입구분이 '전입'인데, 'PKG 구분' 항목에 'P', 'S', 'B' 외 값이 입력 된 경우(대소문자 구분 없이): 'PKG구분(M,P,S)' 메시지 표출

공통
'가입구분'이 미 입력된 경우
'PKG 구분'이 미 입력된 경우
(확인) '멤버사 코드'가 미 입력된 경우: '멤버사명' 메시지 표출
(확인) '멤버사 명'이 미 입력된 경우: '멤버사명' 메시지 표출
'직책/호칭'이 미 입력된 경우
가입자 '성명'이 미 입력된 경우
(확인) 본인 '성별'이 미 입력된 경우: '성별(M,F)' 메시지 표출
(확인) 배우자 '성별'이 미 입력된 경우: '배우자 성별(M,F)' 메시지 표출
(확인) 가입자 'E-Mail'이 미 입력된 경우: '이메일' 메시지 표출
(추가 확인) 본인 '휴대폰 번호' 미 입력된 경우: '휴대번호' 메시지 표출
(추가 확인) 배우자 '휴대폰 번호' 미 입력된 경우: '배우자 휴대번호' 메시지 표출
(추가 확인) 본인과 배우자 연락처 중복 체크: '본인과 배우자 연락처 중복' 메시지 표출
(추가 확인) 본인과 비서 연락처 중복 체크: '본인과 비서 연락처 중복' 메시지 표출 
(추가 확인) 배우자과 비서 연락처 중복 체크: '배우자와 비서 연락처 중복' 메시지 표출   
가입자 '휴대폰' 번호 11자리 미만으로 입력 된 경우('-' 제외)
가입자 '휴대폰' 번호 11자리 초과로 입력 된 경우('-' 제외)
(추가 확인) 배우자 PMS 회원정보의 연락처와 일치 확인: '배우자 매칭 실패, 배우자 연락처 확인(연락처 변경 시, PMS 회원정보 선 변경 처리)' 메시지 표출    
'배우자명' or '배우자성별' or '배우자 휴대폰' 이 입력 되었는데, '배우자명'이 미 입력된 경우
'배우자명' or '배우자성별' or '배우자 휴대폰' 이 입력 되었는데, '배우자성별'이 미 입력된 경우
'배우자명' or '배우자성별' or '배우자 휴대폰' 이 입력 되었는데, '배우자 휴대폰' 번호 11자리 미만으로 입력된 경우('-' 제외)
'배우자명' or '배우자성별' or '배우자 휴대폰' 이 입력 되었는데, '배우자 휴대폰' 번호 11자리 초과로 입력된 경우('-' 제외)
가입자 '성별'에 입력 된 값이 'M', 'F' 외 값이 입력 된 경우(대소문자 구분 없이)
'배우자명' or '배우자성별' or '배우자 휴대폰' 이 입력 되었는데, '배우자성별'에 입력 된 값이 'M', 'F' 외 값이 입력 된 경우(대소문자 구분 없이)
'비서명' or '비서연락처' 가 입력 되었는데, '비서명'이 미 입력된 경우
'비서명' or '비서연락처' 가 입력 되었는데, '비서연락처'가 미 입력된 경우
'비서명' or '비서연락처' 가 입력 되었는데, '비서연락처' 번호 11자리 미만으로 입력된 경우('-' 제외)
'비서명' or '비서연락처' 가 입력 되었는데, '비서연락처' 번호 11자리 초과로 입력된 경우('-' 제외)
(확인) 가입구분이 '신규' ,'갱신', '전입', '전출', '제외' 외 값이 입력 된 경우: '가입구분(갱신,신규,전출,전입,제외)' 메시지 표출
'멤버사명', '멤버사 코드'가 상호 불일치 하는 경우
'전출입멤버사명', '전출입멤버사코드'가 상호 불일치 하는 경우

 

 * 추가 내용
 - 프로시져 생성
 PKG_CorpMemberPkgUpload.SP_CRA06D_TEMP_INSERT2 생성

- 프로시져 셀렉트 추가(배우자 코드)
PKG_CorpMemberPkgUpload.SP_CRA06D_TEMP_SELECT 수정

 - CRA06D_TEMP 테이블 컬럼 추가
ALTER TABLE CRA06D_TEMP ADD SPOUSE_CODE VARCHAR(8); -- 배우자 고객번호
COMMENT ON COLUMN USERVE.CRA06D_TEMP.SPOUSE_CODE IS '배우자 고객번호';